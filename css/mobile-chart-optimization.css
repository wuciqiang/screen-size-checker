/**
 * ç§»åŠ¨ç«¯å›¾è¡¨ä¼˜åŒ–æ ·å¼
 * ä¸“é—¨ä¼˜åŒ–QuickChartå’Œå…¶ä»–å›¾è¡¨åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º
 */

/* ===== ç§»åŠ¨ç«¯å›¾è¡¨åŸºç¡€ä¼˜åŒ– ===== */

@media screen and (max-width: 768px) {
    
    /* QuickChartå›¾è¡¨ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
    .blog-mobile-optimized .mobile-chart {
        width: 100% !important;
        max-width: 100% !important;
        height: auto !important;
        display: block !important;
        margin: var(--spacing-xl) auto !important;
        padding: var(--spacing-sm) !important;
        border-radius: var(--radius-md) !important;
        box-sizing: border-box !important;
        background-color: white !important;
        border: 1px solid var(--border-color) !important;
        box-shadow: var(--shadow-light) !important;
        object-fit: contain !important;
        
        /* å›¾è¡¨åŠ è½½ä¼˜åŒ– */
        loading: lazy !important;
        decoding: async !important;
        
        /* è§¦æ‘¸ä¼˜åŒ– */
        touch-action: pan-x pan-y !important;
        -webkit-user-select: none !important;
        user-select: none !important;
        
        /* è¿‡æ¸¡æ•ˆæœ */
        transition: all var(--transition-medium) !important;
    }

    /* å›¾è¡¨æ‚¬åœæ•ˆæœ */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"]:hover,
    .blog-mobile-optimized .mobile-chart:hover {
        box-shadow: var(--shadow-medium) !important;
        transform: translateY(-2px) !important;
    }

    /* å›¾è¡¨åŠ è½½çŠ¶æ€ */
    .blog-mobile-optimized .mobile-chart.lazy-loading {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%) !important;
        background-size: 200% 100% !important;
        animation: chart-loading-shimmer 1.5s infinite !important;
        min-height: 200px !important;
    }

    /* å›¾è¡¨é”™è¯¯çŠ¶æ€ */
    .blog-mobile-optimized .mobile-chart.load-error {
        background: #ffebee !important;
        border: 2px dashed #e57373 !important;
        color: #c62828 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        min-height: 200px !important;
        font-size: 0.875rem !important;
        text-align: center !important;
    }

    .blog-mobile-optimized .mobile-chart.load-error::before {
        content: "ğŸ“Š Chart failed to load" !important;
        display: block !important;
    }
}

/* ===== å›¾è¡¨è¯´æ˜æ–‡å­—ä¼˜åŒ– ===== */

@media screen and (max-width: 768px) {
    
    /* å›¾è¡¨åçš„è¯´æ˜æ–‡å­— */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + em,
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + i,
    .blog-mobile-optimized .mobile-chart + em,
    .blog-mobile-optimized .mobile-chart + i {
        display: block !important;
        text-align: center !important;
        font-size: clamp(0.8rem, 2vw, 0.9rem) !important;
        line-height: 1.3 !important;
        color: var(--text-secondary) !important;
        margin-top: var(--spacing-sm) !important;
        margin-bottom: var(--spacing-xl) !important;
        font-style: italic !important;
        padding: 0 var(--spacing-md) !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        hyphens: auto !important;
    }

    /* å›¾è¡¨æ ‡é¢˜ä¼˜åŒ– */
    .blog-mobile-optimized .chart-title {
        font-size: clamp(1rem, 2.5vw, 1.125rem) !important;
        line-height: 1.3 !important;
        font-weight: 600 !important;
        color: var(--text-primary) !important;
        text-align: center !important;
        margin-bottom: var(--spacing-sm) !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }
}

/* ===== ä¸åŒç±»å‹å›¾è¡¨çš„ç‰¹æ®Šä¼˜åŒ– ===== */

@media screen and (max-width: 768px) {
    
    /* é¥¼å›¾ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="doughnut"],
    .blog-mobile-optimized .blog-post-content img[src*="pie"] {
        max-width: 320px !important;
        margin: var(--spacing-lg) auto !important;
    }

    /* æ¡å½¢å›¾ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="bar"] {
        max-width: 100% !important;
        min-height: 250px !important;
    }

    /* æŠ˜çº¿å›¾ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="line"] {
        max-width: 100% !important;
        min-height: 200px !important;
    }

    /* æ•£ç‚¹å›¾ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="scatter"] {
        max-width: 100% !important;
        min-height: 250px !important;
    }
}

/* ===== å°å±å¹•è®¾å¤‡å›¾è¡¨ä¼˜åŒ– ===== */

@media screen and (max-width: 480px) {
    
    /* å°å±å¹•å›¾è¡¨åŸºç¡€ä¼˜åŒ– */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
    .blog-mobile-optimized .mobile-chart {
        margin: var(--spacing-lg) auto !important;
        padding: var(--spacing-xs) !important;
        border-radius: var(--radius-sm) !important;
    }

    /* å°å±å¹•å›¾è¡¨è¯´æ˜ */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + em,
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + i,
    .blog-mobile-optimized .mobile-chart + em,
    .blog-mobile-optimized .mobile-chart + i {
        font-size: clamp(0.75rem, 2.25vw, 0.85rem) !important;
        margin-top: var(--spacing-xs) !important;
        margin-bottom: var(--spacing-lg) !important;
        padding: 0 var(--spacing-sm) !important;
    }

    /* å°å±å¹•é¥¼å›¾ */
    .blog-mobile-optimized .blog-post-content img[src*="doughnut"],
    .blog-mobile-optimized .blog-post-content img[src*="pie"] {
        max-width: 280px !important;
    }

    /* å°å±å¹•æ¡å½¢å›¾å’ŒæŠ˜çº¿å›¾ */
    .blog-mobile-optimized .blog-post-content img[src*="bar"],
    .blog-mobile-optimized .blog-post-content img[src*="line"] {
        min-height: 180px !important;
    }
}

/* ===== è¶…å°å±å¹•è®¾å¤‡å›¾è¡¨ä¼˜åŒ– ===== */

@media screen and (max-width: 320px) {
    
    /* è¶…å°å±å¹•å›¾è¡¨ */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
    .blog-mobile-optimized .mobile-chart {
        margin: var(--spacing-md) auto !important;
        padding: 4px !important;
    }

    /* è¶…å°å±å¹•å›¾è¡¨è¯´æ˜ */
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + em,
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"] + i,
    .blog-mobile-optimized .mobile-chart + em,
    .blog-mobile-optimized .mobile-chart + i {
        font-size: clamp(0.7rem, 2.5vw, 0.8rem) !important;
        margin-top: 4px !important;
        margin-bottom: var(--spacing-md) !important;
        padding: 0 8px !important;
    }

    /* è¶…å°å±å¹•é¥¼å›¾ */
    .blog-mobile-optimized .blog-post-content img[src*="doughnut"],
    .blog-mobile-optimized .blog-post-content img[src*="pie"] {
        max-width: 240px !important;
    }

    /* è¶…å°å±å¹•å…¶ä»–å›¾è¡¨ */
    .blog-mobile-optimized .blog-post-content img[src*="bar"],
    .blog-mobile-optimized .blog-post-content img[src*="line"],
    .blog-mobile-optimized .blog-post-content img[src*="scatter"] {
        min-height: 160px !important;
    }
}

/* ===== å›¾è¡¨å®¹å™¨ä¼˜åŒ– ===== */

@media screen and (max-width: 768px) {
    
    /* å›¾è¡¨å®¹å™¨ */
    .blog-mobile-optimized .chart-container {
        width: 100% !important;
        max-width: 100% !important;
        margin: var(--spacing-xl) 0 !important;
        padding: var(--spacing-md) !important;
        background-color: var(--background-card) !important;
        border: 1px solid var(--border-color) !important;
        border-radius: var(--radius-lg) !important;
        box-shadow: var(--shadow-light) !important;
        box-sizing: border-box !important;
        overflow: hidden !important;
    }

    /* å›¾è¡¨å®¹å™¨æ ‡é¢˜ */
    .blog-mobile-optimized .chart-container .chart-title {
        margin-bottom: var(--spacing-md) !important;
        padding-bottom: var(--spacing-sm) !important;
        border-bottom: 1px solid var(--border-light) !important;
    }

    /* å›¾è¡¨å®¹å™¨å†…çš„å›¾è¡¨ */
    .blog-mobile-optimized .chart-container img {
        margin: 0 !important;
        border: none !important;
        box-shadow: none !important;
        background: transparent !important;
        padding: 0 !important;
    }

    /* å›¾è¡¨å®¹å™¨è¯´æ˜ */
    .blog-mobile-optimized .chart-container .chart-description {
        margin-top: var(--spacing-md) !important;
        padding-top: var(--spacing-sm) !important;
        border-top: 1px solid var(--border-light) !important;
        font-size: clamp(0.85rem, 2.25vw, 0.95rem) !important;
        line-height: 1.4 !important;
        color: var(--text-secondary) !important;
        text-align: left !important;
    }
}

/* ===== å›¾è¡¨åŠ è½½åŠ¨ç”» ===== */

@keyframes chart-loading-shimmer {
    0% {
        background-position: -200% 0;
    }
    100% {
        background-position: 200% 0;
    }
}

/* ä½ç«¯è®¾å¤‡ç¦ç”¨å›¾è¡¨åŠ¨ç”» */
.low-end-device .blog-mobile-optimized .mobile-chart.lazy-loading {
    animation: none !important;
    background: #f0f0f0 !important;
}

.low-end-device .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
.low-end-device .blog-mobile-optimized .mobile-chart {
    transition: none !important;
    transform: none !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
}

/* ===== æš—è‰²ä¸»é¢˜å›¾è¡¨ä¼˜åŒ– ===== */

[data-theme="dark"] .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
[data-theme="dark"] .blog-mobile-optimized .mobile-chart {
    background-color: var(--background-card) !important;
    border-color: var(--border-color) !important;
}

[data-theme="dark"] .blog-mobile-optimized .chart-container {
    background-color: var(--background-card) !important;
    border-color: var(--border-color) !important;
}

[data-theme="dark"] .blog-mobile-optimized .mobile-chart.load-error {
    background: #3d2626 !important;
    border-color: #dc2626 !important;
    color: #fca5a5 !important;
}

/* ===== é«˜å¯¹æ¯”åº¦æ¨¡å¼å›¾è¡¨ä¼˜åŒ– ===== */

@media (prefers-contrast: high) {
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
    .blog-mobile-optimized .mobile-chart {
        border: 2px solid currentColor !important;
        box-shadow: none !important;
    }

    .blog-mobile-optimized .chart-container {
        border: 2px solid currentColor !important;
        box-shadow: none !important;
    }
}

/* ===== æ‰“å°æ ·å¼å›¾è¡¨ä¼˜åŒ– ===== */

@media print {
    .blog-mobile-optimized .blog-post-content img[src*="quickchart.io"],
    .blog-mobile-optimized .mobile-chart {
        max-width: 100% !important;
        height: auto !important;
        background: white !important;
        border: 1px solid #000 !important;
        box-shadow: none !important;
        margin: 1rem 0 !important;
        padding: 0.5rem !important;
        page-break-inside: avoid !important;
    }

    .blog-mobile-optimized .chart-container {
        background: white !important;
        border: 1px solid #000 !important;
        box-shadow: none !important;
        page-break-inside: avoid !important;
    }
}